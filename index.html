<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¤ë§ˆíŠ¸ ë¶„ë°˜ ì‹œìŠ¤í…œ - ì²´í—˜íŒ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #9b87f5;
            --primary-dark: #7e69d6;
            --primary-light: #e5dff7;
            --accent: #f093fb;
            --success: #7dd3c0;
            --bg: #fafafa;
            --card-bg: #ffffff;
            --text: #2d3748;
            --text-light: #718096;
            --border: #e2e8f0;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #fafafa 0%, #f0ebff 100%);
            min-height: 100vh;
            color: var(--text);
            padding: 2rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: var(--text-light);
            font-size: 1.1rem;
        }

        .demo-note {
            background: linear-gradient(135deg, #fff4d1 0%, #ffe5a0 100%);
            border: 2px solid #ffd93d;
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .demo-note h3 {
            color: #7a5c00;
            margin-bottom: 0.5rem;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .card {
            background: var(--card-bg);
            border-radius: 24px;
            padding: 2rem;
            box-shadow: 0 8px 32px rgba(139, 92, 246, 0.1);
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 48px rgba(139, 92, 246, 0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--primary-light);
        }

        .card-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .upload-area {
            border: 3px dashed var(--primary-light);
            border-radius: 16px;
            padding: 3rem;
            text-align: center;
            background: linear-gradient(135deg, #ffffff 0%, var(--primary-light) 100%);
        }

        .upload-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.6;
        }

        .upload-text {
            font-size: 1.2rem;
            color: var(--text);
            margin-bottom: 0.5rem;
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans KR', sans-serif;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: white;
            box-shadow: 0 4px 16px rgba(155, 135, 245, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(155, 135, 245, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #6dd5ed 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 2rem;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary-light) 0%, white 100%);
            padding: 1.5rem;
            border-radius: 16px;
            text-align: center;
            border: 2px solid var(--border);
            transition: all 0.3s ease;
        }
        
        .stat-card.pulse {
            animation: pulse 0.6s ease-in-out;
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.08);
                box-shadow: 0 0 20px rgba(155, 135, 245, 0.5);
                border-color: var(--primary);
            }
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        .class-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .class-card {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 16px rgba(139, 92, 246, 0.1);
            border: 2px solid var(--border);
            animation: slideUp 0.4s ease-out;
            animation-fill-mode: both;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .class-card:nth-child(1) { animation-delay: 0.1s; }
        .class-card:nth-child(2) { animation-delay: 0.2s; }
        .class-card:nth-child(3) { animation-delay: 0.3s; }
        .class-card:nth-child(4) { animation-delay: 0.4s; }
        .class-card:nth-child(5) { animation-delay: 0.5s; }
        .class-card:nth-child(6) { animation-delay: 0.6s; }
        .class-card:nth-child(7) { animation-delay: 0.7s; }
        .class-card:nth-child(8) { animation-delay: 0.8s; }

        .class-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: white;
            padding: 1rem;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 1rem;
            font-size: 1.3rem;
            font-weight: 700;
        }

        .class-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
            padding: 0.75rem;
            background: var(--primary-light);
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .class-stat-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-dark);
        }

        .class-stat-label {
            font-size: 0.75rem;
            color: var(--text-light);
        }

        .student-item {
            padding: 0.5rem;
            background: var(--bg);
            border-radius: 8px;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .badge {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .badge-leader {
            background: linear-gradient(135deg, #ffd93d 0%, #ff6b6b 100%);
            color: white;
        }

        .badge-slow {
            background: linear-gradient(135deg, #6dd5ed 0%, #7dd3c0 100%);
            color: white;
        }

        .alert {
            padding: 1rem 1.5rem;
            border-radius: 12px;
            margin: 1rem 0;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .alert-success {
            background: linear-gradient(135deg, #d4f4dd 0%, #a8e6cf 100%);
            color: #2d5016;
            border: 2px solid #7dd3c0;
        }

        .alert-error {
            background: linear-gradient(135deg, #ffe5e5 0%, #ffc9c9 100%);
            color: #7a1616;
            border: 2px solid #ff6b6b;
        }

        .upload-area.dragover {
            background: var(--primary-light);
            border-color: var(--primary);
            transform: scale(1.02);
        }
        
        .upload-area.success {
            background: linear-gradient(135deg, #d4f4dd 0%, #a8e6cf 100%);
            border-color: var(--success);
            animation: successPulse 0.5s ease-in-out;
        }
        
        @keyframes successPulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.02);
            }
        }

        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            .class-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 640px) {
            .class-grid {
                grid-template-columns: 1fr;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
            .class-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ ìŠ¤ë§ˆíŠ¸ ë¶„ë°˜ ì‹œìŠ¤í…œ</h1>
            <p>ë§ˆì‚°ëŒ€í•™êµ ì¹˜ìœ„ìƒê³¼ | ê³µì •í•˜ê³  íš¨ìœ¨ì ì¸ í•™ê¸‰ ë°°ì •</p>
        </div>

        <div class="demo-note">
            <h3>ğŸ¯ ì‹¤ì œ ì²´í—˜ ê°€ëŠ¥í•œ ë²„ì „!</h3>
            <p>í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ â†’ ë°ì´í„° ì…ë ¥ â†’ ì—…ë¡œë“œ â†’ ë¶„ë°˜ ê²°ê³¼ í™•ì¸ê¹Œì§€ ëª¨ë‘ ê°€ëŠ¥í•©ë‹ˆë‹¤</p>
            <p style="font-size: 0.9rem; margin-top: 0.5rem; color: var(--text-light);">
                Excel (.xlsx) ë˜ëŠ” CSV íŒŒì¼ ëª¨ë‘ ì—…ë¡œë“œ ê°€ëŠ¥!
            </p>
        </div>

        <div class="main-grid">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸ“Š</div>
                    <div class="card-title">í•™ìƒ ë°ì´í„° ì—…ë¡œë“œ</div>
                </div>

                <button class="btn btn-success" id="downloadTemplateBtn">
                    <span>ğŸ“¥</span>
                    <span>Excel í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ</span>
                </button>
                <button class="btn btn-success" id="downloadCSVTemplateBtn">
                    <span>ğŸ“„</span>
                    <span>CSV í…œí”Œë¦¿</span>
                </button>

                <div class="upload-area" id="uploadArea" style="margin-top: 1.5rem; cursor: pointer;">
                    <div class="upload-icon">ğŸ“</div>
                    <div class="upload-text">íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</div>
                    <p style="font-size: 0.9rem; color: var(--text-light); margin-top: 0.5rem;">
                        Excel (.xlsx) ë˜ëŠ” CSV íŒŒì¼
                    </p>
                    <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" style="display: none;">
                </div>

                <div id="uploadStatus" style="margin-top: 1rem; display: none;"></div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon">âš™ï¸</div>
                    <div class="card-title">ë¶„ë°˜ ì„¤ì •</div>
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">ì´ ë°˜ ê°œìˆ˜</label>
                    <input type="number" id="classCount" value="8" min="2" max="20" 
                           style="width: 100%; padding: 0.75rem; border: 2px solid var(--border); border-radius: 12px; font-size: 1rem;">
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">ë°˜ ì´ë¦„ í˜•ì‹</label>
                    <select id="classNameFormat" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border); border-radius: 12px; font-size: 1rem;">
                        <option value="alphabet">ì•ŒíŒŒë²³ (Aë°˜, Bë°˜, Cë°˜...)</option>
                        <option value="number">ìˆ«ì (1ë°˜, 2ë°˜, 3ë°˜...)</option>
                        <option value="korean">í•œê¸€ (ê°€ë°˜, ë‚˜ë°˜, ë‹¤ë°˜...)</option>
                    </select>
                </div>

                <button class="btn btn-primary" id="startBtn" disabled style="width: 100%; margin-top: 1rem;">
                    <span>ğŸš€</span>
                    <span>ë¶„ë°˜ ì‹œì‘</span>
                </button>
                
                <button class="btn btn-secondary" id="sampleDataBtn" style="width: 100%; margin-top: 0.5rem;">
                    <span>ğŸ²</span>
                    <span>ìƒ˜í”Œ ë°ì´í„°ë¡œ í…ŒìŠ¤íŠ¸</span>
                </button>
                
                <button class="btn" id="resetBtn" style="width: 100%; margin-top: 0.5rem; background: #ff6b6b; color: white;">
                    <span>ğŸ”„</span>
                    <span>ì´ˆê¸°í™”</span>
                </button>

                <div class="stats-grid" id="statsGrid" style="display: none;">
                    <div class="stat-card">
                        <div class="stat-value">52</div>
                        <div class="stat-label">ì´ í•™ìƒ ìˆ˜</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">8</div>
                        <div class="stat-label">ëŒ€í‘œ í•™ìƒ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">8</div>
                        <div class="stat-label">ëŠë¦°í•™ìŠµì</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card" id="resultsCard" style="display: none;">
            <div class="card-header">
                <div class="card-icon">âœ¨</div>
                <div class="card-title">ë¶„ë°˜ ê²°ê³¼</div>
            </div>

            <div style="text-align: center; margin-bottom: 2rem;">
                <button class="btn btn-success" id="downloadBtn">
                    <span>ğŸ’¾</span>
                    <span>ê²°ê³¼ ë‹¤ìš´ë¡œë“œ (Excel)</span>
                </button>
            </div>

            <div class="stats-grid" id="resultStats" style="margin-bottom: 2rem;"></div>

            <div class="class-grid" id="results"></div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let studentsData = [];
        let divisionResults = [];
        
        // DOM ìš”ì†Œë“¤ (ì „ì—­)
        let uploadArea;
        let fileInput;
        let startBtn;
        let resultsCard;
        let statsGrid;
        let downloadBtn;

        // DOMì´ ë¡œë“œëœ í›„ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', function() {
            // DOM ìš”ì†Œ ì´ˆê¸°í™”
            uploadArea = document.getElementById('uploadArea');
            fileInput = document.getElementById('fileInput');
            startBtn = document.getElementById('startBtn');
            resultsCard = document.getElementById('resultsCard');
            statsGrid = document.getElementById('statsGrid');
            downloadBtn = document.getElementById('downloadBtn');

            if (!uploadArea || !fileInput || !startBtn) {
                console.error('í•„ìˆ˜ DOM ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // íŒŒì¼ ì—…ë¡œë“œ ì´ë²¤íŠ¸
            uploadArea.addEventListener('click', () => fileInput.click());

            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const file = e.dataTransfer.files[0];
                if (file) handleFile(file);
            });

            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) handleFile(file);
            });

            // ë¶„ë°˜ ì‹œì‘
            startBtn.addEventListener('click', divideIntoClasses);

            // ê²°ê³¼ ë‹¤ìš´ë¡œë“œ
            downloadBtn.addEventListener('click', downloadResults);

            // í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
            document.getElementById('downloadTemplateBtn').addEventListener('click', downloadExcelTemplate);
            document.getElementById('downloadCSVTemplateBtn').addEventListener('click', downloadCSVTemplate);
            
            // ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ
            document.getElementById('sampleDataBtn').addEventListener('click', loadSampleData);
            
            // ì´ˆê¸°í™”
            document.getElementById('resetBtn').addEventListener('click', resetAll);
        }); // DOMContentLoaded ì¢…ë£Œ

        // ì´ˆê¸°í™” í•¨ìˆ˜
        function resetAll() {
            studentsData = [];
            divisionResults = [];
            
            if (statsGrid) {
                statsGrid.innerHTML = '';
                statsGrid.style.display = 'none';
            }
            
            if (resultsCard) {
                resultsCard.style.display = 'none';
            }
            
            if (startBtn) {
                startBtn.disabled = true;
            }
            
            if (fileInput) {
                fileInput.value = '';
            }
            
            showAlert('success', 'âœ… ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
        function loadSampleData() {
            // 93ëª…ì˜ ìƒ˜í”Œ ë°ì´í„° ìƒì„±
            const sampleData = [];
            const names = ['ë¯¼ì¤€', 'ì„œì—°', 'ì§€ìš°', 'ì„œì¤€', 'ì˜ˆì€', 'í•˜ì¤€', 'ìœ ì§„', 'ì„œìš°', 'ë¯¼ì„œ', 'ì§€í˜¸',
                          'ì˜ˆì¤€', 'ì„œí˜„', 'ì§€ë¯¼', 'ë„í˜„', 'ìˆ˜ì•„', 'ì§€ì•ˆ', 'ì¤€ì„œ', 'ì„œì•„', 'ì‹œìš°', 'í•˜ì€'];
            const lastNames = ['ê¹€', 'ì´', 'ë°•', 'ìµœ', 'ì •', 'ê°•', 'ì¡°', 'ìœ¤', 'ì¥', 'ì„', 'í•œ', 'ì˜¤', 'ì„œ', 'ì‹ '];
            const classes = ['aë°˜', 'bë°˜', 'cë°˜', 'dë°˜', 'eë°˜', 'fë°˜', 'gë°˜', 'hë°˜'];
            
            let studentNum = 1;
            
            // ëŒ€í‘œ 8ëª…
            for (let i = 0; i < 8; i++) {
                sampleData.push({
                    í•™ë²ˆ: `2025${String(studentNum).padStart(3, '0')}`,
                    ì´ë¦„: lastNames[i % lastNames.length] + names[i % names.length],
                    ì„±ë³„: i % 2 === 0 ? 'ë‚¨' : 'ì—¬',
                    í˜„ì¬ë°˜: classes[i],
                    ì„±ì : (3.5 + Math.random() * 0.8).toFixed(1),
                    ë¹„ê³ : 'ëŒ€í‘œ'
                });
                studentNum++;
            }
            
            // ëŠë¦°í•™ìŠµì 8ëª…
            for (let i = 0; i < 8; i++) {
                sampleData.push({
                    í•™ë²ˆ: `2025${String(studentNum).padStart(3, '0')}`,
                    ì´ë¦„: lastNames[(i+8) % lastNames.length] + names[(i+8) % names.length],
                    ì„±ë³„: i % 2 === 0 ? 'ì—¬' : 'ë‚¨',
                    í˜„ì¬ë°˜: classes[i],
                    ì„±ì : (1.5 + Math.random() * 1.3).toFixed(1),
                    ë¹„ê³ : 'ëŠë¦°í•™ìŠµì'
                });
                studentNum++;
            }
            
            // ì¼ë°˜ í•™ìƒ 77ëª…
            for (let i = 0; i < 77; i++) {
                const score = Math.max(0.5, Math.min(4.5, 3.2 + (Math.random() - 0.5) * 1.2));
                sampleData.push({
                    í•™ë²ˆ: `2025${String(studentNum).padStart(3, '0')}`,
                    ì´ë¦„: lastNames[i % lastNames.length] + names[i % names.length],
                    ì„±ë³„: i % 3 === 0 ? 'ë‚¨' : 'ì—¬',
                    í˜„ì¬ë°˜: classes[i % 8],
                    ì„±ì : score.toFixed(1),
                    ë¹„ê³ : ''
                });
                studentNum++;
            }
            
            processStudentData(sampleData);
            
            // ì—…ë¡œë“œ ì˜ì—­ì— ì„±ê³µ í‘œì‹œ
            if (uploadArea) {
                uploadArea.classList.add('success');
                setTimeout(() => uploadArea.classList.remove('success'), 2000);
            }
            
            const studentCount = studentsData.length;
            showAlert('success', `âœ… ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ ì™„ë£Œ! (${studentCount}ëª…ì˜ í•™ìƒ ë°ì´í„°)`);
            
            // í†µê³„ ì˜ì—­ìœ¼ë¡œ ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤
            setTimeout(() => {
                if (statsGrid) {
                    statsGrid.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }, 300);
        }

        // íŒŒì¼ ì²˜ë¦¬ í•¨ìˆ˜ë“¤ (ì „ì—­)
        function handleFile(file) {
            const fileName = file.name.toLowerCase();
            
            if (!fileName.endsWith('.csv') && !fileName.endsWith('.xlsx') && !fileName.endsWith('.xls')) {
                showAlert('error', 'âŒ CSV ë˜ëŠ” Excel íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                return;
            }

            const reader = new FileReader();
            
            reader.onload = (e) => {
                try {
                    let jsonData;
                    
                    if (fileName.endsWith('.csv')) {
                        // CSV ì²˜ë¦¬
                        const text = e.target.result;
                        jsonData = parseCSV(text);
                    } else {
                        // Excel ì²˜ë¦¬
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                        jsonData = XLSX.utils.sheet_to_json(firstSheet);
                    }
                    
                    processStudentData(jsonData);
                    
                    // ì—…ë¡œë“œ ì˜ì—­ì— ì„±ê³µ í‘œì‹œ
                    if (uploadArea) {
                        uploadArea.classList.add('success');
                        setTimeout(() => uploadArea.classList.remove('success'), 2000);
                    }
                    
                    const studentCount = studentsData.length;
                    showAlert('success', `âœ… ${fileName} ì—…ë¡œë“œ ì™„ë£Œ! (${studentCount}ëª…ì˜ í•™ìƒ ë°ì´í„°)`);
                    
                    // í†µê³„ ì˜ì—­ìœ¼ë¡œ ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤
                    setTimeout(() => {
                        if (statsGrid) {
                            statsGrid.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }
                    }, 300);
                } catch (error) {
                    showAlert('error', 'âŒ íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜: ' + error.message);
                }
            };

            // CSVëŠ” í…ìŠ¤íŠ¸ë¡œ, Excelì€ ë°”ì´ë„ˆë¦¬ë¡œ ì½ê¸°
            if (fileName.endsWith('.csv')) {
                reader.readAsText(file, 'UTF-8');
            } else {
                reader.readAsArrayBuffer(file);
            }
        }

        // CSV íŒŒì‹±
        function parseCSV(text) {
            const lines = text.trim().split('\n');
            const headers = lines[0].split(',').map(h => h.trim());
            const result = [];
            
            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',');
                const obj = {};
                headers.forEach((header, index) => {
                    obj[header] = values[index] ? values[index].trim() : '';
                });
                result.push(obj);
            }
            
            return result;
        }

        // í•™ìƒ ë°ì´í„° ì²˜ë¦¬
        function processStudentData(data) {
            // ì´ì „ ê²°ê³¼ ìˆ¨ê¸°ê¸°
            if (resultsCard) {
                resultsCard.style.display = 'none';
            }
            divisionResults = [];
            
            studentsData = data
                .filter(row => row['ì´ë¦„'])
                .map((row, index) => {
                    const remark = (row['ë¹„ê³ '] || '').toString().trim();
                    return {
                        id: index + 1,
                        studentId: row['í•™ë²ˆ'] || `2025${String(index + 1).padStart(3, '0')}`,
                        name: row['ì´ë¦„'],
                        gender: row['ì„±ë³„'] || '',
                        currentClass: row['í˜„ì¬ë°˜'] || '',
                        score: parseFloat(row['ì„±ì '] || 0),
                        isLeader: remark === 'ëŒ€í‘œ',
                        isSlowLearner: remark === 'ëŠë¦°í•™ìŠµì',
                        remark: remark
                    };
                });

            if (studentsData.length === 0) {
                showAlert('error', 'âŒ ìœ íš¨í•œ í•™ìƒ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            updateStats();
            if (startBtn) startBtn.disabled = false;
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats() {
            const total = studentsData.length;
            const leaders = studentsData.filter(s => s.isLeader).length;
            const slowLearners = studentsData.filter(s => s.isSlowLearner).length;

            statsGrid.innerHTML = `
                <div class="stat-card pulse">
                    <div class="stat-value">${total}</div>
                    <div class="stat-label">ì´ í•™ìƒ ìˆ˜</div>
                </div>
                <div class="stat-card pulse" style="animation-delay: 0.1s;">
                    <div class="stat-value">${leaders}</div>
                    <div class="stat-label">ëŒ€í‘œ í•™ìƒ</div>
                </div>
                <div class="stat-card pulse" style="animation-delay: 0.2s;">
                    <div class="stat-value">${slowLearners}</div>
                    <div class="stat-label">ëŠë¦°í•™ìŠµì</div>
                </div>
            `;
            statsGrid.style.display = 'grid';
        }

        // ë¶„ë°˜ ì•Œê³ ë¦¬ì¦˜
        function divideIntoClasses() {
            const classCount = parseInt(document.getElementById('classCount').value);
            
            // ë°°ì—´ ì„ê¸° í•¨ìˆ˜
            function shuffleArray(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }
            
            // ì´ˆê¸°í™”
            const classes = Array.from({ length: classCount }, (_, i) => ({
                name: getClassName(i),
                students: [],
                totalScore: 0,
                leaderCount: 0,
                slowLearnerCount: 0,
                currentClassCounts: {} // í˜„ì¬ ë°˜ë³„ í•™ìƒ ìˆ˜ ì¶”ì 
            }));

            // 1ë‹¨ê³„: ëŒ€í‘œ í•™ìƒ ê· ë“± ë°°ì¹˜ - ì™„ì „ ëœë¤
            const leaders = shuffleArray(studentsData.filter(s => s.isLeader));
            leaders.forEach((leader) => {
                // ë°°ì—´ ë³µì‚¬í•´ì„œ ì •ë ¬ (ì›ë³¸ classes ë°°ì—´ì€ ìœ ì§€)
                const sortedClasses = [...classes].sort((a, b) => {
                    // 0ìˆœìœ„: ë‚¨í•™ìƒ ëŒ€í‘œì¸ ê²½ìš° 1ëª…ì¸ ë°˜ ìµœìš°ì„ 
                    if (leader.gender === 'ë‚¨') {
                        const maleCountA = a.students.filter(s => s.gender === 'ë‚¨').length;
                        const maleCountB = b.students.filter(s => s.gender === 'ë‚¨').length;
                        
                        const isOneA = maleCountA === 1;
                        const isOneB = maleCountB === 1;
                        
                        if (isOneA && !isOneB) return -1;
                        if (!isOneA && isOneB) return 1;
                        
                        // ë‚¨í•™ìƒ ìˆ˜ê°€ ì ì€ ë°˜ ìš°ì„  (ê³¨ê³ ë£¨)
                        if (maleCountA !== maleCountB) {
                            return maleCountA - maleCountB;
                        }
                    }
                    
                    // 1ìˆœìœ„: ëŒ€í‘œ ìˆ˜ê°€ ì ì€ ë°˜ (ê· ë“± ë°°ì¹˜)
                    if (a.leaderCount !== b.leaderCount) {
                        return a.leaderCount - b.leaderCount;
                    }
                    // 2ìˆœìœ„: í˜„ì¬ ë°˜ ì¶œì‹ ì´ ì ì€ ë°˜
                    const countA = a.currentClassCounts[leader.currentClass] || 0;
                    const countB = b.currentClassCounts[leader.currentClass] || 0;
                    if (countA !== countB) return countA - countB;
                    // 3ìˆœìœ„: ëœë¤
                    return Math.random() - 0.5;
                });
                
                const targetClass = sortedClasses[0];
                targetClass.students.push(leader);
                targetClass.totalScore += leader.score;
                targetClass.leaderCount++;
                targetClass.currentClassCounts[leader.currentClass] = 
                    (targetClass.currentClassCounts[leader.currentClass] || 0) + 1;
            });

            // 2ë‹¨ê³„: ëŠë¦°í•™ìŠµì ê· ë“± ë°°ì¹˜ - ì™„ì „ ëœë¤
            const slowLearners = shuffleArray(
                studentsData.filter(s => s.isSlowLearner && !s.isLeader)
            );
            slowLearners.forEach((student) => {
                const sortedClasses = [...classes].sort((a, b) => {
                    // 0ìˆœìœ„: ë‚¨í•™ìƒ ëŠë¦°í•™ìŠµìì¸ ê²½ìš° 1ëª…ì¸ ë°˜ ìµœìš°ì„ 
                    if (student.gender === 'ë‚¨') {
                        const maleCountA = a.students.filter(s => s.gender === 'ë‚¨').length;
                        const maleCountB = b.students.filter(s => s.gender === 'ë‚¨').length;
                        
                        const isOneA = maleCountA === 1;
                        const isOneB = maleCountB === 1;
                        
                        if (isOneA && !isOneB) return -1;
                        if (!isOneA && isOneB) return 1;
                        
                        // ë‚¨í•™ìƒ ìˆ˜ê°€ ì ì€ ë°˜ ìš°ì„  (ê³¨ê³ ë£¨)
                        if (maleCountA !== maleCountB) {
                            return maleCountA - maleCountB;
                        }
                    }
                    
                    // 1ìˆœìœ„: ëŠë¦°í•™ìŠµì ìˆ˜ê°€ ì ì€ ë°˜ (ê· ë“± ë°°ì¹˜)
                    if (a.slowLearnerCount !== b.slowLearnerCount) {
                        return a.slowLearnerCount - b.slowLearnerCount;
                    }
                    // 2ìˆœìœ„: í˜„ì¬ ë°˜ ì¶œì‹ ì´ ì ì€ ë°˜
                    const countA = a.currentClassCounts[student.currentClass] || 0;
                    const countB = b.currentClassCounts[student.currentClass] || 0;
                    if (countA !== countB) return countA - countB;
                    // 3ìˆœìœ„: ëœë¤
                    return Math.random() - 0.5;
                });

                const targetClass = sortedClasses[0];
                targetClass.students.push(student);
                targetClass.totalScore += student.score;
                targetClass.slowLearnerCount++;
                targetClass.currentClassCounts[student.currentClass] = 
                    (targetClass.currentClassCounts[student.currentClass] || 0) + 1;
            });

            // 3ë‹¨ê³„: ë‚˜ë¨¸ì§€ í•™ìƒ ë°°ì¹˜ (í˜„ì¬ ë°˜ + ì„±ì  ëª¨ë‘ ê³ ë ¤) - ëœë¤ ì„ê¸°
            const remainingStudents = shuffleArray(
                studentsData.filter(s => !s.isLeader && !s.isSlowLearner)
            ).sort((a, b) => b.score - a.score);

            // ë‚¨í•™ìƒê³¼ ì—¬í•™ìƒ ë¶„ë¦¬
            const maleStudents = remainingStudents.filter(s => s.gender === 'ë‚¨');
            const femaleStudents = remainingStudents.filter(s => s.gender === 'ì—¬');
            
            // ë‚¨í•™ìƒ ë¨¼ì € ë°°ì¹˜ (ìµœì†Œ 2ëª…ì”©)
            maleStudents.forEach(student => {
                const sortedClasses = [...classes].sort((a, b) => {
                    const maleCountA = a.students.filter(s => s.gender === 'ë‚¨').length;
                    const maleCountB = b.students.filter(s => s.gender === 'ë‚¨').length;
                    
                    // 0ìˆœìœ„: ë‚¨í•™ìƒì´ 1ëª…ì¸ ë°˜ì„ ìµœìš°ì„  (2ëª…ìœ¼ë¡œ ë§Œë“¤ê¸°)
                    const isOneA = maleCountA === 1;
                    const isOneB = maleCountB === 1;
                    if (isOneA && !isOneB) return -1;
                    if (!isOneA && isOneB) return 1;
                    
                    // 1ìˆœìœ„: ë‚¨í•™ìƒ ìˆ˜ê°€ ì ì€ ë°˜ ìš°ì„  (ê³¨ê³ ë£¨ ë¶„ë°°)
                    if (maleCountA !== maleCountB) {
                        return maleCountA - maleCountB;
                    }
                    
                    // 2ìˆœìœ„: í˜„ì¬ ë°˜ ì¶œì‹  ìˆ˜
                    const currentA = a.currentClassCounts[student.currentClass] || 0;
                    const currentB = b.currentClassCounts[student.currentClass] || 0;
                    if (currentA !== currentB) {
                        return currentA - currentB;
                    }
                    
                    // 3ìˆœìœ„: í‰ê·  ì„±ì 
                    const avgA = a.students.length > 0 ? a.totalScore / a.students.length : 0;
                    const avgB = b.students.length > 0 ? b.totalScore / b.students.length : 0;
                    if (Math.abs(avgA - avgB) > 0.1) {
                        return avgA - avgB;
                    }
                    
                    // 4ìˆœìœ„: ì „ì²´ í•™ìƒ ìˆ˜
                    return a.students.length - b.students.length;
                });
                
                const targetClass = sortedClasses[0];
                targetClass.students.push(student);
                targetClass.totalScore += student.score;
                targetClass.currentClassCounts[student.currentClass] = 
                    (targetClass.currentClassCounts[student.currentClass] || 0) + 1;
            });
            
            // ì—¬í•™ìƒ ë°°ì¹˜
            femaleStudents.forEach(student => {
                const sortedClasses = [...classes].sort((a, b) => {
                    // 1ìˆœìœ„: í˜„ì¬ ë°˜ ì¶œì‹  ìˆ˜
                    const currentA = a.currentClassCounts[student.currentClass] || 0;
                    const currentB = b.currentClassCounts[student.currentClass] || 0;
                    if (currentA !== currentB) {
                        return currentA - currentB;
                    }
                    
                    // 2ìˆœìœ„: í‰ê·  ì„±ì 
                    const avgA = a.students.length > 0 ? a.totalScore / a.students.length : 0;
                    const avgB = b.students.length > 0 ? b.totalScore / b.students.length : 0;
                    if (Math.abs(avgA - avgB) > 0.1) {
                        return avgA - avgB;
                    }
                    
                    // 3ìˆœìœ„: ì „ì²´ í•™ìƒ ìˆ˜
                    return a.students.length - b.students.length;
                });
                
                const targetClass = sortedClasses[0];
                targetClass.students.push(student);
                targetClass.totalScore += student.score;
                targetClass.currentClassCounts[student.currentClass] = 
                    (targetClass.currentClassCounts[student.currentClass] || 0) + 1;
            });

            divisionResults = classes;
            showResults();
        }

        // ë°˜ ì´ë¦„ ìƒì„±
        function getClassName(index) {
            const format = document.getElementById('classNameFormat').value;
            
            if (format === 'number') {
                return `${index + 1}ë°˜`;
            } else if (format === 'korean') {
                const koreanLetters = ['ê°€', 'ë‚˜', 'ë‹¤', 'ë¼', 'ë§ˆ', 'ë°”', 'ì‚¬', 'ì•„', 'ì', 'ì°¨', 'ì¹´', 'íƒ€'];
                return `${koreanLetters[index]}ë°˜`;
            } else {
                return `${String.fromCharCode(65 + index)}ë°˜`;
            }
        }

        // ê²°ê³¼ í‘œì‹œ
        function showResults() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';

            // ë°˜ ì´ë¦„ ìˆœì„œëŒ€ë¡œ ì •ë ¬ (Aë°˜, Bë°˜, Cë°˜... ë˜ëŠ” 1ë°˜, 2ë°˜, 3ë°˜...)
            const sortedResults = [...divisionResults].sort((a, b) => {
                // ìˆ«ì ì¶”ì¶œí•´ì„œ ë¹„êµ
                const numA = parseInt(a.name.match(/\d+/)?.[0] || a.name.charCodeAt(0));
                const numB = parseInt(b.name.match(/\d+/)?.[0] || b.name.charCodeAt(0));
                return numA - numB;
            });

            sortedResults.forEach(classData => {
                const avgScore = classData.students.length > 0 
                    ? (classData.totalScore / classData.students.length).toFixed(1) 
                    : 0;

                // ì„±ë³„ í†µê³„
                const maleCount = classData.students.filter(s => s.gender === 'ë‚¨').length;
                const femaleCount = classData.students.filter(s => s.gender === 'ì—¬').length;

                const card = document.createElement('div');
                card.className = 'class-card';
                
                // í˜„ì¬ ë°˜ë³„ ë¶„í¬ ê³„ì‚°
                const currentClassDist = {};
                classData.students.forEach(s => {
                    const cc = s.currentClass || 'ë¯¸ë°°ì •';
                    currentClassDist[cc] = (currentClassDist[cc] || 0) + 1;
                });
                const currentClassDistStr = Object.entries(currentClassDist)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 3)
                    .map(([cls, cnt]) => `${cls}:${cnt}ëª…`)
                    .join(', ');
                
                const studentsHTML = classData.students.map(s => `
                    <div class="student-item">
                        <div style="font-size: 0.85rem; color: #666; margin-bottom: 0.2rem;">${s.studentId || ''}</div>
                        <div style="font-weight: 600;">
                            ${s.name} 
                            ${s.gender ? `<span style="color: ${s.gender === 'ë‚¨' ? '#4A90E2' : '#E24A90'}; font-size: 0.9rem;">(${s.gender})</span>` : ''}
                            <span style="color: var(--primary);">${s.score}ì </span>
                        </div>
                        <div style="margin-top: 0.2rem;">
                            ${s.isLeader ? '<span class="badge badge-leader">ëŒ€í‘œ</span>' : ''}
                            ${s.isSlowLearner ? '<span class="badge badge-slow">ëŠë¦°í•™ìŠµì</span>' : ''}
                        </div>
                    </div>
                `).join('');

                card.innerHTML = `
                    <div class="class-header">${classData.name}</div>
                    <div class="class-stats">
                        <div>
                            <div class="class-stat-value">${classData.students.length}ëª…</div>
                            <div class="class-stat-label">í•™ìƒ ìˆ˜</div>
                        </div>
                        <div>
                            <div class="class-stat-value">${avgScore}</div>
                            <div class="class-stat-label">í‰ê· </div>
                        </div>
                        <div>
                            <div class="class-stat-value">${classData.leaderCount}</div>
                            <div class="class-stat-label">ëŒ€í‘œ</div>
                        </div>
                        <div>
                            <div class="class-stat-value" style="font-size: 0.9rem;">
                                <span style="color: #4A90E2;">ë‚¨${maleCount}</span> / 
                                <span style="color: #E24A90;">ì—¬${femaleCount}</span>
                            </div>
                            <div class="class-stat-label">ì„±ë³„</div>
                        </div>
                    </div>
                    <div style="font-size: 0.75rem; color: var(--text-light); text-align: center; margin-bottom: 0.5rem; padding: 0.5rem; background: var(--bg); border-radius: 8px;">
                        ê¸°ì¡´ ì¶œì‹ : ${currentClassDistStr}
                    </div>
                    ${studentsHTML}
                `;
                
                resultsDiv.appendChild(card);
            });

            // í†µê³„ ê³„ì‚°
            const avgScores = divisionResults.map(c => 
                c.students.length > 0 ? c.totalScore / c.students.length : 0
            );
            const maxAvg = Math.max(...avgScores);
            const minAvg = Math.min(...avgScores);
            const diff = (maxAvg - minAvg).toFixed(2);
            const balanceScore = (100 - (diff / maxAvg * 100)).toFixed(1);

            document.getElementById('resultStats').innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${diff}ì </div>
                    <div class="stat-label">í‰ê·  ì„±ì  í¸ì°¨</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${balanceScore}ì </div>
                    <div class="stat-label">ê· í˜•ë„ ì ìˆ˜</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${divisionResults.length}ê°œ</div>
                    <div class="stat-label">ë¶„ë°˜ ìˆ˜</div>
                </div>
            `;

            resultsCard.style.display = 'block';
            resultsCard.scrollIntoView({ behavior: 'smooth' });
        }

        // ê²°ê³¼ ë‹¤ìš´ë¡œë“œ
        function downloadResults() {
            const wb = XLSX.utils.book_new();

            // ë°˜ë³„ ì‹œíŠ¸
            divisionResults.forEach(classData => {
                const wsData = [
                    ['ë²ˆí˜¸', 'í•™ë²ˆ', 'ì´ë¦„', 'ì„±ë³„', 'í˜„ì¬ë°˜', 'ì„±ì ', 'ë¹„ê³ '],
                    ...classData.students.map((s, i) => [
                        i + 1,
                        s.studentId || '',
                        s.name,
                        s.gender || '',
                        s.currentClass || '',
                        s.score,
                        s.isLeader ? 'ëŒ€í‘œ' : (s.isSlowLearner ? 'ëŠë¦°í•™ìŠµì' : '')
                    ])
                ];
                const ws = XLSX.utils.aoa_to_sheet(wsData);
                XLSX.utils.book_append_sheet(wb, ws, classData.name);
            });

            // ìš”ì•½ ì‹œíŠ¸
            const summaryData = [
                ['ë°˜ ì´ë¦„', 'í•™ìƒ ìˆ˜', 'í‰ê·  ì„±ì ', 'ëŒ€í‘œ ìˆ˜', 'ëŠë¦°í•™ìŠµì ìˆ˜'],
                ...divisionResults.map(c => [
                    c.name,
                    c.students.length,
                    c.students.length > 0 ? (c.totalScore / c.students.length).toFixed(2) : 0,
                    c.leaderCount,
                    c.slowLearnerCount
                ])
            ];
            const summaryWs = XLSX.utils.aoa_to_sheet(summaryData);
            XLSX.utils.book_append_sheet(wb, summaryWs, 'ìš”ì•½');

            const fileName = `ë¶„ë°˜ê²°ê³¼_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, fileName);

            showAlert('success', 'âœ… ê²°ê³¼ íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // Excel í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
        function downloadExcelTemplate() {
            const wb = XLSX.utils.book_new();
            
            const wsData = [
                ['í•™ë²ˆ', 'ì´ë¦„', 'ì„±ë³„', 'í˜„ì¬ë°˜', 'ì„±ì ', 'ë¹„ê³ '],
                ['2025001', 'í™ê¸¸ë™', 'ë‚¨', 'aë°˜', 4.2, 'ëŒ€í‘œ'],
                ['2025002', 'ê¹€ì˜í¬', 'ì—¬', 'dë°˜', 2.1, 'ëŠë¦°í•™ìŠµì'],
                ['2025003', 'ì´ì² ìˆ˜', 'ë‚¨', '', 4, 'ëŒ€í‘œ'],
                ['2025004', 'ë°•ë¯¼ìˆ˜', 'ë‚¨', 'eë°˜', 3.3, ''],
                ['2025005', 'ìµœì§€ìš°', 'ì—¬', 'bë°˜', 3.8, ''],
            ];
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            ws['!cols'] = [
                { wch: 10 },  // í•™ë²ˆ
                { wch: 12 },  // ì´ë¦„
                { wch: 8 },   // ì„±ë³„
                { wch: 10 },  // í˜„ì¬ë°˜
                { wch: 8 },   // ì„±ì 
                { wch: 15 }   // ë¹„ê³ 
            ];
            XLSX.utils.book_append_sheet(wb, ws, 'í•™ìƒëª…ë‹¨');
            
            XLSX.writeFile(wb, 'í•™ìƒëª…ë‹¨_ì…ë ¥í…œí”Œë¦¿.xlsx');
            showAlert('success', 'âœ… Excel í…œí”Œë¦¿ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // CSV í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
        function downloadCSVTemplate() {
            const csvContent = 'í•™ë²ˆ,ì´ë¦„,ì„±ë³„,í˜„ì¬ë°˜,ì„±ì ,ë¹„ê³ \n' +
                               '2025001,í™ê¸¸ë™,ë‚¨,aë°˜,4.2,ëŒ€í‘œ\n' +
                               '2025002,ê¹€ì˜í¬,ì—¬,dë°˜,2.1,ëŠë¦°í•™ìŠµì\n' +
                               '2025003,ì´ì² ìˆ˜,ë‚¨,,4,ëŒ€í‘œ\n' +
                               '2025004,ë°•ë¯¼ìˆ˜,ë‚¨,eë°˜,3.3,\n' +
                               '2025005,ìµœì§€ìš°,ì—¬,bë°˜,3.8,';
            
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'í•™ìƒëª…ë‹¨_ì…ë ¥í…œí”Œë¦¿.csv';
            link.click();
            showAlert('success', 'âœ… CSV í…œí”Œë¦¿ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // ì•Œë¦¼ í‘œì‹œ
        function showAlert(type, message) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.innerHTML = `
                <span>${type === 'success' ? 'âœ…' : 'âŒ'}</span>
                <div>${message}</div>
            `;
            
            const uploadStatus = document.getElementById('uploadStatus');
            uploadStatus.innerHTML = '';
            uploadStatus.appendChild(alertDiv);
            uploadStatus.style.display = 'block';
            
            setTimeout(() => {
                uploadStatus.style.display = 'none';
            }, 3000);
        }
    </script>
</body>
</html>
